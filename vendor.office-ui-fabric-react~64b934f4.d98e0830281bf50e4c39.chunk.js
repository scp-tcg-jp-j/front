(window.webpackJsonp=window.webpackJsonp||[]).push([[55],{MgI6:function(e,t,s){"use strict";s.d(t,"a",(function(){return R}));var o=s("mrSG"),n=s("q1tI"),r=s("9h5o"),c=s("WOvX"),i=s("4qJ4"),a=s("WJ1O"),l=s("i+8s"),u=s("HTq8"),g=s("gwZ5"),h=s("9DMD"),d=s("OIc5"),m=s("6lyR"),p=s("VvEo"),f=s("Khh+"),v=Object(r.a)(),S=Object(c.a)(m.a,p.b,void 0,{scope:"SuggestionItem"}),R=function(e){function t(t){var s=e.call(this,t)||this;return s._forceResolveButton=n.createRef(),s._searchForMoreButton=n.createRef(),s._selectedElement=n.createRef(),s.tryHandleKeyDown=function(e,t){var o=!1,n=null,r=s.state.selectedActionType,c=s.props.suggestions.length;if(e===i.a.down)switch(r){case d.a.forceResolve:c>0?(s._refocusOnSuggestions(e),n=d.a.none):n=s._searchForMoreButton.current?d.a.searchMore:d.a.forceResolve;break;case d.a.searchMore:s._forceResolveButton.current?n=d.a.forceResolve:c>0?(s._refocusOnSuggestions(e),n=d.a.none):n=d.a.searchMore;break;case d.a.none:-1===t&&s._forceResolveButton.current&&(n=d.a.forceResolve)}else if(e===i.a.up)switch(r){case d.a.forceResolve:s._searchForMoreButton.current?n=d.a.searchMore:c>0&&(s._refocusOnSuggestions(e),n=d.a.none);break;case d.a.searchMore:c>0?(s._refocusOnSuggestions(e),n=d.a.none):s._forceResolveButton.current&&(n=d.a.forceResolve);break;case d.a.none:-1===t&&s._searchForMoreButton.current&&(n=d.a.searchMore)}return null!==n&&(s.setState({selectedActionType:n}),o=!0),o},s._getAlertText=function(){var e=s.props,t=e.isLoading,o=e.isSearching,n=e.suggestions,r=e.suggestionsAvailableAlertText,c=e.noResultsFoundText;if(!t&&!o){if(n.length>0)return r||"";if(c)return c}return""},s._getMoreResults=function(){s.props.onGetMoreResults&&s.props.onGetMoreResults()},s._forceResolve=function(){s.props.createGenericItem&&s.props.createGenericItem()},s._shouldShowForceResolve=function(){return!!s.props.showForceResolve&&s.props.showForceResolve()},s._onClickTypedSuggestionsItem=function(e,t){return function(o){s.props.onSuggestionClick(o,e,t)}},s._refocusOnSuggestions=function(e){"function"==typeof s.props.refocusSuggestions&&s.props.refocusSuggestions(e)},s._onRemoveTypedSuggestionsItem=function(e,t){return function(o){(0,s.props.onSuggestionRemove)(o,e,t),o.stopPropagation()}},Object(a.a)(s),s.state={selectedActionType:d.a.none},s}return Object(o.c)(t,e),t.prototype.componentDidMount=function(){this.scrollSelected(),this.activeSelectedElement=this._selectedElement?this._selectedElement.current:null},t.prototype.componentDidUpdate=function(){this._selectedElement.current&&this.activeSelectedElement!==this._selectedElement.current&&(this.scrollSelected(),this.activeSelectedElement=this._selectedElement.current)},t.prototype.render=function(){var e,t,s=this,r=this.props,c=r.forceResolveText,i=r.mostRecentlyUsedHeaderText,a=r.searchForMoreText,m=r.className,p=r.moreSuggestionsAvailable,S=r.noResultsFoundText,R=r.suggestions,_=r.isLoading,b=r.isSearching,y=r.loadingText,M=r.onRenderNoResultFound,A=r.searchingText,T=r.isMostRecentlyUsedVisible,B=r.resultsMaximumNumber,N=r.resultsFooterFull,F=r.resultsFooter,E=r.isResultsFooterVisible,O=void 0===E||E,w=r.suggestionsHeaderText,k=r.suggestionsClassName,C=r.theme,I=r.styles,j=r.suggestionsListId;this._classNames=I?v(I,{theme:C,className:m,suggestionsClassName:k,forceResolveButtonSelected:this.state.selectedActionType===d.a.forceResolve,searchForMoreButtonSelected:this.state.selectedActionType===d.a.searchMore}):{root:Object(l.a)("ms-Suggestions",m,f.root),title:Object(l.a)("ms-Suggestions-title",f.suggestionsTitle),searchForMoreButton:Object(l.a)("ms-SearchMore-button",f.actionButton,(e={},e["is-selected "+f.buttonSelected]=this.state.selectedActionType===d.a.searchMore,e)),forceResolveButton:Object(l.a)("ms-forceResolve-button",f.actionButton,(t={},t["is-selected "+f.buttonSelected]=this.state.selectedActionType===d.a.forceResolve,t)),suggestionsAvailable:Object(l.a)("ms-Suggestions-suggestionsAvailable",f.suggestionsAvailable),suggestionsContainer:Object(l.a)("ms-Suggestions-container",f.suggestionsContainer,k),noSuggestions:Object(l.a)("ms-Suggestions-none",f.suggestionsNone)};var x=this._classNames.subComponentStyles?this._classNames.subComponentStyles.spinner:void 0,L=I?{styles:x}:{className:Object(l.a)("ms-Suggestions-spinner",f.suggestionsSpinner)},D=function(){return S?n.createElement("div",{className:s._classNames.noSuggestions},S):null},G=w;T&&i&&(G=i);var V=void 0;O&&(V=R.length>=B?N:F);var H=!(R&&R.length||_),J=H||_?{role:"dialog",id:j}:{},q=this.state.selectedActionType===d.a.forceResolve?"sug-selectedAction":void 0,U=this.state.selectedActionType===d.a.searchMore?"sug-selectedAction":void 0;return n.createElement("div",Object(o.a)({className:this._classNames.root},J),n.createElement(h.a,{message:this._getAlertText(),"aria-live":"polite"}),G?n.createElement("div",{className:this._classNames.title},G):null,c&&this._shouldShowForceResolve()&&n.createElement(u.a,{componentRef:this._forceResolveButton,className:this._classNames.forceResolveButton,id:q,onClick:this._forceResolve,"data-automationid":"sug-forceResolve"},c),_&&n.createElement(g.a,Object(o.a)({},L,{label:y})),H?M?M(void 0,D):D():this._renderSuggestions(),a&&p&&n.createElement(u.a,{componentRef:this._searchForMoreButton,className:this._classNames.searchForMoreButton,iconProps:{iconName:"Search"},id:U,onClick:this._getMoreResults,"data-automationid":"sug-searchForMore"},a),b?n.createElement(g.a,Object(o.a)({},L,{label:A})):null,!V||p||T||b?null:n.createElement("div",{className:this._classNames.title},V(this.props)))},t.prototype.hasSuggestedAction=function(){return!!this._searchForMoreButton.current||!!this._forceResolveButton.current},t.prototype.hasSuggestedActionSelected=function(){return this.state.selectedActionType!==d.a.none},t.prototype.executeSelectedAction=function(){switch(this.state.selectedActionType){case d.a.forceResolve:this._forceResolve();break;case d.a.searchMore:this._getMoreResults()}},t.prototype.focusAboveSuggestions=function(){this._forceResolveButton.current?this.setState({selectedActionType:d.a.forceResolve}):this._searchForMoreButton.current&&this.setState({selectedActionType:d.a.searchMore})},t.prototype.focusBelowSuggestions=function(){this._searchForMoreButton.current?this.setState({selectedActionType:d.a.searchMore}):this._forceResolveButton.current&&this.setState({selectedActionType:d.a.forceResolve})},t.prototype.focusSearchForMoreButton=function(){this._searchForMoreButton.current&&this._searchForMoreButton.current.focus()},t.prototype.scrollSelected=function(){this._selectedElement.current&&void 0!==this._selectedElement.current.scrollIntoView&&this._selectedElement.current.scrollIntoView(!1)},t.prototype._renderSuggestions=function(){var e=this,t=this.props,s=t.onRenderSuggestion,o=t.removeSuggestionAriaLabel,r=t.suggestionsItemClassName,c=t.resultsMaximumNumber,i=t.showRemoveButtons,a=t.suggestionsContainerAriaLabel,l=t.suggestionsListId,u=this.props.suggestions,g=S,h=-1;return u.some((function(e,t){return!!e.selected&&(h=t,!0)})),c&&(u=h>=c?u.slice(h-c+1,h+1):u.slice(0,c)),0===u.length?null:n.createElement("div",{className:this._classNames.suggestionsContainer,id:l,role:"listbox","aria-label":a},u.map((function(t,c){return n.createElement("div",{ref:t.selected?e._selectedElement:void 0,key:t.item.key?t.item.key:c},n.createElement(g,{suggestionModel:t,RenderSuggestion:s,onClick:e._onClickTypedSuggestionsItem(t.item,c),className:r,showRemoveButton:i,removeButtonAriaLabel:o,onRemoveItem:e._onRemoveTypedSuggestionsItem(t.item,c),id:"sug-"+c}))})))},t}(n.Component)}}]);
//# sourceMappingURL=vendor.office-ui-fabric-react~64b934f4.d98e0830281bf50e4c39.bundle.map