(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{AqBJ:function(e,t,o){"use strict";var n;o.d(t,"a",(function(){return n})),function(e){e[e.Normal=0]="Normal",e[e.Divider=1]="Divider",e[e.Header=2]="Header"}(n||(n={}))},TtgZ:function(e,t,o){"use strict";function n(e,t){for(var o=[],n=0,i=t;n<i.length;n++){var s=e[i[n]];s&&o.push(s)}return o}o.d(t,"a",(function(){return n}))},W890:function(e,t,o){"use strict";o.d(t,"a",(function(){return m}));var n=o("mrSG"),i=o("q1tI"),s=o("0xmZ"),r=o("gKHf"),a=o("4qJ4"),c=o("cwxN"),l=o("elao"),u=o("WJ1O"),d=o("3uSm"),h=o("i+8s"),_=o("ybKx"),p=o("8lCt"),f=o("4PRO"),v=o("WgWP"),g=o("+rda"),m=function(e){function t(t){var o=e.call(this,t)||this;o._root=i.createRef(),o.ignoreNextFocus=function(){o._handleNextFocus(!1)},o._onSelectionChange=function(){var e=o.props.selection,t=e.isModal&&e.isModal();o.setState({isModal:t})},o._onMouseDownCapture=function(e){var t=e.target;if(document.activeElement===t||Object(s.a)(document.activeElement,t)){if(Object(s.a)(t,o._root.current))for(;t!==o._root.current;){if(o._hasAttribute(t,"data-selection-invoke")){o.ignoreNextFocus();break}t=Object(r.a)(t)}}else o.ignoreNextFocus()},o._onFocus=function(e){var t=e.target,n=o.props.selection,i=o._isCtrlPressed||o._isMetaPressed,s=o._getSelectionMode();if(o._shouldHandleFocus&&s!==g.b.none){var r=o._hasAttribute(t,"data-selection-toggle"),a=o._findItemRoot(t);if(!r&&a){var c=o._getItemIndex(a);i?(n.setIndexSelected(c,n.isIndexSelected(c),!0),o.props.enterModalOnTouch&&o._isTouch&&n.setModal&&(n.setModal(!0),o._setIsTouch(!1))):o.props.isSelectedOnFocus&&o._onItemSurfaceClick(e,c)}}o._handleNextFocus(!1)},o._onMouseDown=function(e){o._updateModifiers(e);var t=e.target,n=o._findItemRoot(t);if(!o._isSelectionDisabled(t))for(;t!==o._root.current&&!o._hasAttribute(t,"data-selection-all-toggle");){if(n){if(o._hasAttribute(t,"data-selection-toggle"))break;if(o._hasAttribute(t,"data-selection-invoke"))break;if(!(t!==n&&!o._shouldAutoSelect(t)||o._isShiftPressed||o._isCtrlPressed||o._isMetaPressed)){o._onInvokeMouseDown(e,o._getItemIndex(n));break}if(o.props.disableAutoSelectOnInputElements&&("A"===t.tagName||"BUTTON"===t.tagName||"INPUT"===t.tagName))return}t=Object(r.a)(t)}},o._onTouchStartCapture=function(e){o._setIsTouch(!0)},o._onClick=function(e){var t=o.props.enableTouchInvocationTarget,n=void 0!==t&&t;o._updateModifiers(e);for(var i=e.target,s=o._findItemRoot(i),a=o._isSelectionDisabled(i);i!==o._root.current;){if(o._hasAttribute(i,"data-selection-all-toggle")){a||o._onToggleAllClick(e);break}if(s){var c=o._getItemIndex(s);if(o._hasAttribute(i,"data-selection-toggle")){a||(o._isShiftPressed?o._onItemSurfaceClick(e,c):o._onToggleClick(e,c));break}if(o._isTouch&&n&&o._hasAttribute(i,"data-selection-touch-invoke")||o._hasAttribute(i,"data-selection-invoke")){o._onInvokeClick(e,c);break}if(i===s){a||o._onItemSurfaceClick(e,c);break}if("A"===i.tagName||"BUTTON"===i.tagName||"INPUT"===i.tagName)return}i=Object(r.a)(i)}},o._onContextMenu=function(e){var t=e.target,n=o.props,i=n.onItemContextMenu,s=n.selection;if(i){var r=o._findItemRoot(t);if(r){var a=o._getItemIndex(r);o._onInvokeMouseDown(e,a),i(s.getItems()[a],a,e.nativeEvent)||e.preventDefault()}}},o._onDoubleClick=function(e){var t=e.target,n=o.props.onItemInvoked,i=o._findItemRoot(t);if(i&&n&&!o._isInputElement(t)){for(var s=o._getItemIndex(i);t!==o._root.current&&!o._hasAttribute(t,"data-selection-toggle")&&!o._hasAttribute(t,"data-selection-invoke");){if(t===i){o._onInvokeClick(e,s);break}t=Object(r.a)(t)}t=Object(r.a)(t)}},o._onKeyDownCapture=function(e){o._updateModifiers(e),o._handleNextFocus(!0)},o._onKeyDown=function(e){o._updateModifiers(e);var t=e.target,n=o._isSelectionDisabled(t),i=o.props.selection,s=e.which===a.a.a&&(o._isCtrlPressed||o._isMetaPressed),c=e.which===a.a.escape;if(!o._isInputElement(t)){var l=o._getSelectionMode();if(s&&l===g.b.multiple&&!i.isAllSelected())return n||i.setAllSelected(!0),e.stopPropagation(),void e.preventDefault();if(c&&i.getSelectedCount()>0)return n||i.setAllSelected(!1),e.stopPropagation(),void e.preventDefault();var u=o._findItemRoot(t);if(u)for(var d=o._getItemIndex(u);t!==o._root.current&&!o._hasAttribute(t,"data-selection-toggle");){if(o._shouldAutoSelect(t)){n||o._onInvokeMouseDown(e,d);break}if(!(e.which!==a.a.enter&&e.which!==a.a.space||"BUTTON"!==t.tagName&&"A"!==t.tagName&&"INPUT"!==t.tagName))return!1;if(t===u){if(e.which===a.a.enter)return o._onInvokeClick(e,d),void e.preventDefault();if(e.which===a.a.space)return n||o._onToggleClick(e,d),void e.preventDefault();break}t=Object(r.a)(t)}}},o._events=new c.a(o),o._async=new l.a(o),Object(u.a)(o);var n=o.props.selection,d=n.isModal&&n.isModal();return o.state={isModal:d},o}return Object(n.c)(t,e),t.getDerivedStateFromProps=function(e,t){var o=e.selection.isModal&&e.selection.isModal();return Object(n.a)(Object(n.a)({},t),{isModal:o})},t.prototype.componentDidMount=function(){var e=Object(d.a)(this._root.current);this._events.on(e,"keydown, keyup",this._updateModifiers,!0),this._events.on(document,"click",this._findScrollParentAndTryClearOnEmptyClick),this._events.on(document.body,"touchstart",this._onTouchStartCapture,!0),this._events.on(document.body,"touchend",this._onTouchStartCapture,!0),this._events.on(this.props.selection,"change",this._onSelectionChange)},t.prototype.render=function(){var e=this.state.isModal;return i.createElement("div",{className:Object(h.a)("ms-SelectionZone",this.props.className,{"ms-SelectionZone--modal":!!e}),ref:this._root,onKeyDown:this._onKeyDown,onMouseDown:this._onMouseDown,onKeyDownCapture:this._onKeyDownCapture,onClick:this._onClick,role:"presentation",onDoubleClick:this._onDoubleClick,onContextMenu:this._onContextMenu,onMouseDownCapture:this._onMouseDownCapture,onFocusCapture:this._onFocus,"data-selection-is-modal":!!e||void 0},this.props.children,i.createElement(_.a,null))},t.prototype.componentDidUpdate=function(e){var t=this.props.selection;t!==e.selection&&(this._events.off(e.selection),this._events.on(t,"change",this._onSelectionChange))},t.prototype.componentWillUnmount=function(){this._events.dispose(),this._async.dispose()},t.prototype._isSelectionDisabled=function(e){if(this._getSelectionMode()===g.b.none)return!0;for(;e!==this._root.current;){if(this._hasAttribute(e,"data-selection-disabled"))return!0;e=Object(r.a)(e)}return!1},t.prototype._onToggleAllClick=function(e){var t=this.props.selection;this._getSelectionMode()===g.b.multiple&&(t.toggleAllSelected(),e.stopPropagation(),e.preventDefault())},t.prototype._onToggleClick=function(e,t){var o=this.props.selection,n=this._getSelectionMode();if(o.setChangeEvents(!1),this.props.enterModalOnTouch&&this._isTouch&&!o.isIndexSelected(t)&&o.setModal&&(o.setModal(!0),this._setIsTouch(!1)),n===g.b.multiple)o.toggleIndexSelected(t);else{if(n!==g.b.single)return void o.setChangeEvents(!0);var i=o.isIndexSelected(t),s=o.isModal&&o.isModal();o.setAllSelected(!1),o.setIndexSelected(t,!i,!0),s&&o.setModal&&o.setModal(!0)}o.setChangeEvents(!0),e.stopPropagation()},t.prototype._onInvokeClick=function(e,t){var o=this.props,n=o.selection,i=o.onItemInvoked;i&&(i(n.getItems()[t],t,e.nativeEvent),e.preventDefault(),e.stopPropagation())},t.prototype._onItemSurfaceClick=function(e,t){var o=this.props.selection,n=this._isCtrlPressed||this._isMetaPressed,i=this._getSelectionMode();i===g.b.multiple?this._isShiftPressed&&!this._isTabPressed?o.selectToIndex(t,!n):n?o.toggleIndexSelected(t):this._clearAndSelectIndex(t):i===g.b.single&&this._clearAndSelectIndex(t)},t.prototype._onInvokeMouseDown=function(e,t){this.props.selection.isIndexSelected(t)||this._clearAndSelectIndex(t)},t.prototype._findScrollParentAndTryClearOnEmptyClick=function(e){var t=Object(p.e)(this._root.current);this._events.off(document,"click",this._findScrollParentAndTryClearOnEmptyClick),this._events.on(t,"click",this._tryClearOnEmptyClick),(t&&e.target instanceof Node&&t.contains(e.target)||t===e.target)&&this._tryClearOnEmptyClick(e)},t.prototype._tryClearOnEmptyClick=function(e){!this.props.selectionPreservedOnEmptyClick&&this._isNonHandledClick(e.target)&&this.props.selection.setAllSelected(!1)},t.prototype._clearAndSelectIndex=function(e){var t=this.props.selection;if(!(1===t.getSelectedCount()&&t.isIndexSelected(e))){var o=t.isModal&&t.isModal();t.setChangeEvents(!1),t.setAllSelected(!1),t.setIndexSelected(e,!0,!0),(o||this.props.enterModalOnTouch&&this._isTouch)&&(t.setModal&&t.setModal(!0),this._isTouch&&this._setIsTouch(!1)),t.setChangeEvents(!0)}},t.prototype._updateModifiers=function(e){this._isShiftPressed=e.shiftKey,this._isCtrlPressed=e.ctrlKey,this._isMetaPressed=e.metaKey;var t=e.keyCode;this._isTabPressed=!!t&&t===a.a.tab},t.prototype._findItemRoot=function(e){for(var t=this.props.selection;e!==this._root.current;){var o=e.getAttribute("data-selection-index"),n=Number(o);if(null!==o&&n>=0&&n<t.getItems().length)break;e=Object(r.a)(e)}if(e!==this._root.current)return e},t.prototype._getItemIndex=function(e){return Number(e.getAttribute("data-selection-index"))},t.prototype._shouldAutoSelect=function(e){return this._hasAttribute(e,"data-selection-select")},t.prototype._hasAttribute=function(e,t){for(var o=!1;!o&&e!==this._root.current;)o="true"===e.getAttribute(t),e=Object(r.a)(e);return o},t.prototype._isInputElement=function(e){return"INPUT"===e.tagName||"TEXTAREA"===e.tagName},t.prototype._isNonHandledClick=function(e){var t=Object(f.a)();if(t&&e)for(;e&&e!==t.documentElement;){if(Object(v.n)(e))return!1;e=Object(r.a)(e)}return!0},t.prototype._handleNextFocus=function(e){var t=this;this._shouldHandleFocusTimeoutId&&(this._async.clearTimeout(this._shouldHandleFocusTimeoutId),this._shouldHandleFocusTimeoutId=void 0),this._shouldHandleFocus=e,e&&this._async.setTimeout((function(){t._shouldHandleFocus=!1}),100)},t.prototype._setIsTouch=function(e){var t=this;this._isTouchTimeoutId&&(this._async.clearTimeout(this._isTouchTimeoutId),this._isTouchTimeoutId=void 0),this._isTouch=!0,e&&this._async.setTimeout((function(){t._isTouch=!1}),300)},t.prototype._getSelectionMode=function(){var e=this.props.selection,t=this.props.selectionMode;return void 0===t?e?e.mode:g.b.none:t},t.defaultProps={isSelectedOnFocus:!0,selectionMode:g.b.multiple},t}(i.Component)}}]);
//# sourceMappingURL=vendor.office-ui-fabric-react~40b40c8d.a92a0b33dc1e2bde10af.bundle.map