(window.webpackJsonp=window.webpackJsonp||[]).push([[57],{QoT3:function(e,t,s){"use strict";s.d(t,"a",(function(){return A})),s.d(t,"b",(function(){return k}));var n=s("mrSG"),i=s("q1tI"),o=s("9h5o"),r=s("WOvX"),u=s("4qJ4"),a=s("0xmZ"),g=s("WJ1O"),c=s("elao"),l=s("mWkG"),p=s("i+8s"),d=s("CBcM"),h=s("LrGI"),m=s("RyIQ"),S=s("aupw"),f=s("AyH7"),v=s("W890"),b=s("+rda"),I=s("MgI6"),y=s("otIS"),R=s("yXa5"),x=s("iBHr"),E=s("MnuA"),_=s("nCPe"),V=Object(o.a)();var A=function(e){function t(t){var s,n=e.call(this,t)||this;n.root=i.createRef(),n.input=i.createRef(),n.focusZone=i.createRef(),n.suggestionElement=i.createRef(),n.SuggestionOfProperType=I.a,n._styledSuggestions=(s=n.SuggestionOfProperType,Object(r.a)(s,y.a,void 0,{scope:"Suggestions"})),n.dismissSuggestions=function(e){var t=function(){var t=!0;n.props.onDismiss&&(t=n.props.onDismiss(e,n.suggestionStore.currentSuggestion?n.suggestionStore.currentSuggestion.item:void 0)),(!e||e&&!e.defaultPrevented)&&!1!==t&&n.canAddItems()&&n.suggestionStore.hasSelectedSuggestion()&&n.state.suggestedDisplayValue&&n.addItemByIndex(0)};n.currentPromise?n.currentPromise.then((function(){return t()})):t(),n.setState({suggestionsVisible:!1})},n.refocusSuggestions=function(e){n.resetFocus(),n.suggestionStore.suggestions&&n.suggestionStore.suggestions.length>0&&(e===u.a.up?n.suggestionStore.setSelectedSuggestion(n.suggestionStore.suggestions.length-1):e===u.a.down&&n.suggestionStore.setSelectedSuggestion(0))},n.onInputChange=function(e){n.updateValue(e),n.setState({moreSuggestionsAvailable:!0,isMostRecentlyUsedVisible:!1})},n.onSuggestionClick=function(e,t,s){n.addItemByIndex(s)},n.onSuggestionRemove=function(e,t,s){n.props.onRemoveSuggestion&&n.props.onRemoveSuggestion(t),n.suggestionStore.removeSuggestion(s)},n.onInputFocus=function(e){n.selection.setAllSelected(!1),n.state.isFocused||(n.setState({isFocused:!0}),n._userTriggeredSuggestions(),n.props.inputProps&&n.props.inputProps.onFocus&&n.props.inputProps.onFocus(e))},n.onInputBlur=function(e){n.props.inputProps&&n.props.inputProps.onBlur&&n.props.inputProps.onBlur(e)},n.onBlur=function(e){if(n.state.isFocused){var t=e.relatedTarget;null===e.relatedTarget&&(t=document.activeElement),t&&!Object(a.a)(n.root.current,t)&&(n.setState({isFocused:!1}),n.props.onBlur&&n.props.onBlur(e))}},n.onClick=function(e){void 0!==n.props.inputProps&&void 0!==n.props.inputProps.onClick&&n.props.inputProps.onClick(e),0===e.button&&n._userTriggeredSuggestions()},n.onKeyDown=function(e){var t=e.which;switch(t){case u.a.escape:n.state.suggestionsVisible&&(n.setState({suggestionsVisible:!1}),e.preventDefault(),e.stopPropagation());break;case u.a.tab:case u.a.enter:n.suggestionElement.current&&n.suggestionElement.current.hasSuggestedActionSelected()?n.suggestionElement.current.executeSelectedAction():!e.shiftKey&&n.suggestionStore.hasSelectedSuggestion()&&n.state.suggestionsVisible?(n.completeSuggestion(),e.preventDefault(),e.stopPropagation()):n._completeGenericSuggestion();break;case u.a.backspace:n.props.disabled||n.onBackspace(e),e.stopPropagation();break;case u.a.del:n.props.disabled||(n.input.current&&e.target===n.input.current.inputElement&&n.state.suggestionsVisible&&-1!==n.suggestionStore.currentIndex?(n.props.onRemoveSuggestion&&n.props.onRemoveSuggestion(n.suggestionStore.currentSuggestion.item),n.suggestionStore.removeSuggestion(n.suggestionStore.currentIndex),n.forceUpdate()):n.onBackspace(e)),e.stopPropagation();break;case u.a.up:n.input.current&&e.target===n.input.current.inputElement&&n.state.suggestionsVisible&&(n.suggestionElement.current&&n.suggestionElement.current.tryHandleKeyDown(t,n.suggestionStore.currentIndex)?(e.preventDefault(),e.stopPropagation(),n.forceUpdate()):n.suggestionElement.current&&n.suggestionElement.current.hasSuggestedAction()&&0===n.suggestionStore.currentIndex?(e.preventDefault(),e.stopPropagation(),n.suggestionElement.current.focusAboveSuggestions(),n.suggestionStore.deselectAllSuggestions(),n.forceUpdate()):n.suggestionStore.previousSuggestion()&&(e.preventDefault(),e.stopPropagation(),n.onSuggestionSelect()));break;case u.a.down:n.input.current&&e.target===n.input.current.inputElement&&n.state.suggestionsVisible&&(n.suggestionElement.current&&n.suggestionElement.current.tryHandleKeyDown(t,n.suggestionStore.currentIndex)?(e.preventDefault(),e.stopPropagation(),n.forceUpdate()):n.suggestionElement.current&&n.suggestionElement.current.hasSuggestedAction()&&n.suggestionStore.currentIndex+1===n.suggestionStore.suggestions.length?(e.preventDefault(),e.stopPropagation(),n.suggestionElement.current.focusBelowSuggestions(),n.suggestionStore.deselectAllSuggestions(),n.forceUpdate()):n.suggestionStore.nextSuggestion()&&(e.preventDefault(),e.stopPropagation(),n.onSuggestionSelect()))}},n.onItemChange=function(e,t){var s=n.state.items;if(t>=0){var i=s;i[t]=e,n._updateSelectedItems(i)}},n.onGetMoreResults=function(){n.setState({isSearching:!0},(function(){if(n.props.onGetMoreResults&&n.input.current){var e=n.props.onGetMoreResults(n.input.current.value,n.state.items),t=e,s=e;Array.isArray(t)?(n.updateSuggestions(t),n.setState({isSearching:!1})):s.then&&s.then((function(e){n.updateSuggestions(e),n.setState({isSearching:!1})}))}else n.setState({isSearching:!1});n.input.current&&n.input.current.focus(),n.setState({moreSuggestionsAvailable:!1,isResultsFooterVisible:!0})}))},n.completeSelection=function(e){n.addItem(e),n.updateValue(""),n.input.current&&n.input.current.clear(),n.setState({suggestionsVisible:!1})},n.addItemByIndex=function(e){n.completeSelection(n.suggestionStore.getSuggestionAtIndex(e).item)},n.addItem=function(e){var t=n.props.onItemSelected?n.props.onItemSelected(e):e;if(null!==t){var s=t,i=t;if(i&&i.then)i.then((function(e){var t=n.state.items.concat([e]);n._updateSelectedItems(t)}));else{var o=n.state.items.concat([s]);n._updateSelectedItems(o)}n.setState({suggestedDisplayValue:""})}},n.removeItem=function(e,t){var s=n.state.items,i=s.indexOf(e);if(i>=0){var o=s.slice(0,i).concat(s.slice(i+1));n._updateSelectedItems(o)}},n.removeItems=function(e){var t=n.state.items.filter((function(t){return-1===e.indexOf(t)}));n._updateSelectedItems(t)},n._shouldFocusZoneEnterInnerZone=function(e){if(n.state.suggestionsVisible)switch(e.which){case u.a.up:case u.a.down:return!0}return e.which===u.a.enter},n._onResolveSuggestions=function(e){var t=n.props.onResolveSuggestions(e,n.state.items);null!==t&&n.updateSuggestionsList(t,e)},n._completeGenericSuggestion=function(){if(n.props.onValidateInput&&n.input.current&&n.props.onValidateInput(n.input.current.value)!==x.a.invalid&&n.props.createGenericItem){var e=n.props.createGenericItem(n.input.current.value,n.props.onValidateInput(n.input.current.value));n.suggestionStore.createGenericSuggestion(e),n.completeSuggestion()}},n._userTriggeredSuggestions=function(){if(!n.state.suggestionsVisible){var e=n.input.current?n.input.current.value:"";e?0===n.suggestionStore.suggestions.length?n._onResolveSuggestions(e):n.setState({isMostRecentlyUsedVisible:!1,suggestionsVisible:!0}):n.onEmptyInputFocus()}},Object(g.a)(n),n._async=new c.a(n);var o=t.selectedItems||t.defaultSelectedItems||[];return n._id=Object(l.a)(),n._ariaMap={selectedItems:"selected-items-"+n._id,selectedSuggestionAlert:"selected-suggestion-alert-"+n._id,suggestionList:"suggestion-list-"+n._id,combobox:"combobox-"+n._id},n.suggestionStore=new R.a,n.selection=new f.a({onSelectionChanged:function(){return n.onSelectionChange()}}),n.selection.setItems(o),n.state={items:o,suggestedDisplayValue:"",isMostRecentlyUsedVisible:!1,moreSuggestionsAvailable:!1,isFocused:!1,isSearching:!1,selectedIndices:[]},n}return Object(n.c)(t,e),t.getDerivedStateFromProps=function(e){return e.selectedItems?{items:e.selectedItems}:null},Object.defineProperty(t.prototype,"items",{get:function(){return this.state.items},enumerable:!0,configurable:!0}),t.prototype.componentDidMount=function(){this.selection.setItems(this.state.items),this._onResolveSuggestions=this._async.debounce(this._onResolveSuggestions,this.props.resolveDelay)},t.prototype.componentDidUpdate=function(e,t){if(this.state.items&&this.state.items!==t.items){var s=this.selection.getSelectedIndices()[0];this.selection.setItems(this.state.items),this.state.isFocused&&this.state.items.length<t.items.length&&(this.selection.setIndexSelected(s,!0,!0),this.resetFocus(s))}},t.prototype.componentWillUnmount=function(){this.currentPromise&&(this.currentPromise=void 0),this._async.dispose()},t.prototype.focus=function(){this.focusZone.current&&this.focusZone.current.focus()},t.prototype.focusInput=function(){this.input.current&&this.input.current.focus()},t.prototype.completeSuggestion=function(e){this.suggestionStore.hasSelectedSuggestion()&&this.input.current?this.completeSelection(this.suggestionStore.currentSuggestion.item):e&&this._completeGenericSuggestion()},t.prototype.render=function(){var e=this.state,t=e.suggestedDisplayValue,s=e.isFocused,o=e.items,r=this.props,u=r.className,a=r.inputProps,g=r.disabled,c=r.theme,l=r.styles,m=this.props.enableSelectedSuggestionAlert?this._ariaMap.selectedSuggestionAlert:"",S=this.state.suggestionsVisible?this._ariaMap.suggestionList:"",f=this.canAddItems(),I=l?V(l,{theme:c,className:u,isFocused:s,disabled:g,inputClassName:a&&a.className}):{root:Object(p.a)("ms-BasePicker",u||""),text:Object(p.a)("ms-BasePicker-text",_.pickerText,this.state.isFocused&&_.inputFocused),itemsWrapper:_.pickerItems,input:Object(p.a)("ms-BasePicker-input",_.pickerInput,a&&a.className),screenReaderText:_.screenReaderOnly};return i.createElement("div",{ref:this.root,className:I.root,onKeyDown:this.onKeyDown,onBlur:this.onBlur},i.createElement(d.a,{componentRef:this.focusZone,direction:h.a.bidirectional,shouldEnterInnerZone:this._shouldFocusZoneEnterInnerZone,role:f?"combobox":void 0,id:f?this._ariaMap.combobox:void 0,"aria-label":f?this.props["aria-label"]:void 0,"aria-expanded":f?!!this.state.suggestionsVisible:void 0,"aria-owns":f&&S||void 0,"aria-haspopup":S&&this.suggestionStore.suggestions.length>0?"listbox":"dialog"},this.getSuggestionsAlert(I.screenReaderText),i.createElement(v.a,{selection:this.selection,selectionMode:b.b.multiple},i.createElement("div",{className:I.text,role:"presentation"},o.length>0&&i.createElement("span",{id:this._ariaMap.selectedItems,className:I.itemsWrapper,role:"list"},this.renderItems()),this.canAddItems()&&i.createElement(E.a,Object(n.a)({spellCheck:!1},a,{className:I.input,componentRef:this.input,onClick:this.onClick,onFocus:this.onInputFocus,onBlur:this.onInputBlur,onInputValueChange:this.onInputChange,suggestedDisplayValue:t,"arial-labelledby":this.props["aria-label"]?this._ariaMap.combobox:void 0,"aria-describedby":o.length>0?this._ariaMap.selectedItems:void 0,"aria-controls":S+" "+m||void 0,"aria-activedescendant":this.getActiveDescendant(),role:"textbox",disabled:g,onInputChange:this.props.onInputChange}))))),this.renderSuggestions())},t.prototype.canAddItems=function(){var e=this.state.items,t=this.props.itemLimit;return void 0===t||e.length<t},t.prototype.renderSuggestions=function(){var e=this._styledSuggestions;return this.state.suggestionsVisible&&this.input?i.createElement(m.a,Object(n.a)({isBeakVisible:!1,gapSpace:5,target:this.input.current?this.input.current.inputElement:void 0,onDismiss:this.dismissSuggestions,directionalHint:S.a.bottomLeftEdge,directionalHintForRTL:S.a.bottomRightEdge},this.props.pickerCalloutProps),i.createElement(e,Object(n.a)({onRenderSuggestion:this.props.onRenderSuggestionsItem,onSuggestionClick:this.onSuggestionClick,onSuggestionRemove:this.onSuggestionRemove,suggestions:this.suggestionStore.getSuggestions(),componentRef:this.suggestionElement,onGetMoreResults:this.onGetMoreResults,moreSuggestionsAvailable:this.state.moreSuggestionsAvailable,isLoading:this.state.suggestionsLoading,isSearching:this.state.isSearching,isMostRecentlyUsedVisible:this.state.isMostRecentlyUsedVisible,isResultsFooterVisible:this.state.isResultsFooterVisible,refocusSuggestions:this.refocusSuggestions,removeSuggestionAriaLabel:this.props.removeButtonAriaLabel,suggestionsListId:this._ariaMap.suggestionList,createGenericItem:this._completeGenericSuggestion},this.props.pickerSuggestionsProps))):null},t.prototype.renderItems=function(){var e=this,t=this.props,s=t.disabled,n=t.removeButtonAriaLabel,i=this.props.onRenderItem,o=this.state,r=o.items,u=o.selectedIndices;return r.map((function(t,o){return i({item:t,index:o,key:t.key?t.key:o,selected:-1!==u.indexOf(o),onRemoveItem:function(){return e.removeItem(t,!0)},disabled:s,onItemChange:e.onItemChange,removeButtonAriaLabel:n})}))},t.prototype.resetFocus=function(e){var t=this.state.items;if(t.length&&e>=0){var s=this.root.current&&this.root.current.querySelectorAll("[data-selection-index]")[Math.min(e,t.length-1)];s&&this.focusZone.current&&this.focusZone.current.focusElement(s)}else this.canAddItems()?this.input.current&&this.input.current.focus():this.resetFocus(t.length-1)},t.prototype.onSuggestionSelect=function(){if(this.suggestionStore.currentSuggestion){var e=this.input.current?this.input.current.value:"",t=this._getTextFromItem(this.suggestionStore.currentSuggestion.item,e);this.setState({suggestedDisplayValue:t})}},t.prototype.onSelectionChange=function(){this.setState({selectedIndices:this.selection.getSelectedIndices()})},t.prototype.updateSuggestions=function(e){this.suggestionStore.updateSuggestions(e,0),this.forceUpdate()},t.prototype.onEmptyInputFocus=function(){var e=this.props.onEmptyResolveSuggestions?this.props.onEmptyResolveSuggestions:this.props.onEmptyInputFocus;if(e){var t=e(this.state.items);this.updateSuggestionsList(t),this.setState({isMostRecentlyUsedVisible:!0,suggestionsVisible:!0,moreSuggestionsAvailable:!1})}},t.prototype.updateValue=function(e){this._onResolveSuggestions(e)},t.prototype.updateSuggestionsList=function(e,t){var s=this,n=e,i=e;if(Array.isArray(n))this._updateAndResolveValue(t,n);else if(i&&i.then){this.setState({suggestionsLoading:!0}),this.suggestionStore.updateSuggestions([]),void 0!==t?this.setState({suggestionsVisible:this._getShowSuggestions()}):this.setState({suggestionsVisible:this.input.current&&this.input.current.inputElement===document.activeElement});var o=this.currentPromise=i;o.then((function(e){o===s.currentPromise&&s._updateAndResolveValue(t,e)}))}},t.prototype.resolveNewValue=function(e,t){var s=this;this.updateSuggestions(t);var n=void 0;this.suggestionStore.currentSuggestion&&(n=this._getTextFromItem(this.suggestionStore.currentSuggestion.item,e)),this.setState({suggestedDisplayValue:n,suggestionsVisible:this._getShowSuggestions()},(function(){return s.setState({suggestionsLoading:!1})}))},t.prototype.onChange=function(e){this.props.onChange&&this.props.onChange(e)},t.prototype.onBackspace=function(e){(this.state.items.length&&!this.input.current||this.input.current&&!this.input.current.isValueSelected&&0===this.input.current.cursorLocation)&&(this.selection.getSelectedCount()>0?this.removeItems(this.selection.getSelection()):this.removeItem(this.state.items[this.state.items.length-1]))},t.prototype.getActiveDescendant=function(){if(!this.state.suggestionsLoading){var e=this.suggestionStore.currentIndex;return e<0&&this.suggestionElement.current&&this.suggestionElement.current.hasSuggestedAction()?"sug-selectedAction":e>-1&&!this.state.suggestionsLoading?"sug-"+e:void 0}},t.prototype.getSuggestionsAlert=function(e){void 0===e&&(e=_.screenReaderOnly);var t=this.suggestionStore.currentIndex;if(this.props.enableSelectedSuggestionAlert){var s=t>-1?this.suggestionStore.getSuggestionAtIndex(this.suggestionStore.currentIndex):void 0,n=s?s.ariaLabel:void 0;return i.createElement("div",{className:e,role:"alert",id:this._ariaMap.selectedSuggestionAlert,"aria-live":"assertive"},n," ")}},t.prototype._updateAndResolveValue=function(e,t){void 0!==e?this.resolveNewValue(e,t):(this.suggestionStore.updateSuggestions(t,-1),this.state.suggestionsLoading&&this.setState({suggestionsLoading:!1}))},t.prototype._updateSelectedItems=function(e){var t=this;this.props.selectedItems?this.onChange(e):this.setState({items:e},(function(){t._onSelectedItemsUpdated(e)}))},t.prototype._onSelectedItemsUpdated=function(e){this.onChange(e)},t.prototype._getShowSuggestions=function(){return void 0!==this.input.current&&null!==this.input.current&&this.input.current.inputElement===document.activeElement&&""!==this.input.current.value},t.prototype._getTextFromItem=function(e,t){return this.props.getTextFromItem?this.props.getTextFromItem(e,t):""},t}(i.Component),k=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(n.c)(t,e),t.prototype.render=function(){var e=this.state,t=e.suggestedDisplayValue,s=e.isFocused,o=this.props,r=o.className,u=o.inputProps,a=o.disabled,g=o.theme,c=o.styles,l=this.props.enableSelectedSuggestionAlert?this._ariaMap.selectedSuggestionAlert:"",m=this.state.suggestionsVisible?this._ariaMap.suggestionList:"",S=c?V(c,{theme:g,className:r,isFocused:s,inputClassName:u&&u.className}):{root:Object(p.a)("ms-BasePicker",r||""),text:Object(p.a)("ms-BasePicker-text",_.pickerText,this.state.isFocused&&_.inputFocused),input:Object(p.a)("ms-BasePicker-input",_.pickerInput,u&&u.className),screenReaderText:_.screenReaderOnly};return i.createElement("div",{ref:this.root,onBlur:this.onBlur},i.createElement("div",{className:S.root,onKeyDown:this.onKeyDown},this.getSuggestionsAlert(S.screenReaderText),i.createElement("div",{className:S.text,"aria-owns":m||void 0,"aria-expanded":!!this.state.suggestionsVisible,"aria-haspopup":m&&this.suggestionStore.suggestions.length>0?"listbox":"dialog",role:"combobox"},i.createElement(E.a,Object(n.a)({},u,{className:S.input,componentRef:this.input,onFocus:this.onInputFocus,onBlur:this.onInputBlur,onClick:this.onClick,onInputValueChange:this.onInputChange,suggestedDisplayValue:t,"aria-activedescendant":this.getActiveDescendant(),role:"textbox",disabled:a,"aria-controls":m+" "+l||void 0,onInputChange:this.props.onInputChange})))),this.renderSuggestions(),i.createElement(v.a,{selection:this.selection,selectionMode:b.b.single},i.createElement(d.a,{componentRef:this.focusZone,className:"ms-BasePicker-selectedItems",isCircularNavigation:!0,direction:h.a.bidirectional,shouldEnterInnerZone:this._shouldFocusZoneEnterInnerZone,id:this._ariaMap.selectedItems,role:"list"},this.renderItems())))},t.prototype.onBackspace=function(e){},t}(A)}}]);
//# sourceMappingURL=vendor.office-ui-fabric-react~7b910858.826e648b3108d83536c6.bundle.map